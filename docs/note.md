# 注意事項
## VS Code
- 可以在keyboard shortcut添加自定義快捷鍵，直接複製f5的設定就好，只要把args的值改成task.json裡的label的值，它就會呼叫。
## Git
- 如果push失敗，就直接到資料夾去pull跟push。
- 版本管理模型
    - [master] 版本必須是穩定可產品化發布的狀態。
    - [develop] 平常開發的主要分支。主要負責記錄開發狀態下相對穩定的版本，即完成了某個功能或修復了某個bug後的開發穩定版本。
    - [feature] 開發新功能的分支。每個新功能都會形成一個分支，等到功能開發測試完畢後，再合併到develop分支。
    - [release] 測試版本分支。從develop分支出來，進行可產品化的環境下的測試，如果出現缺陷，就在此分支下修復。測試通過後，分別併入master和develop。
    - [hotfix] 緊急線上修復分支。若線上出現bug且特別緊急時，就可以從master拉出分支到這裡進行修復，完成後分別併入master和develop。
    - 圖片可見[敏捷開發下的版本管理][ref_url5]。
## Lua撰寫細則
- function、table、userdata、thread是複製引用(call by reference)，所以A變量操作它們，B變量也會改變。
- boolean、string、number是複製值(call by value)，所以A變量操作它們，B變量不會改變。
- Lua是靜態作用域，所以有常用的函數記得要在同一作用域下聲明，原因詳見下條。
- local變量訪問速度比global變量快30%。所以被多次訪問的global變量，都應該存進local變量中。
- 給table添加元素時，tab[#tab + 1] = a比table.insert(tab, a)效率高，遠比table.insert(tab, 1, a)效率高。
- 4種循環方式(正序數值for循環、反序數值for循環、ipairs泛型for循環、pairs泛型for循環)根據習慣選擇就好，效率差別不大。
- 在循環內創建變數和循環外創建變數的效率取決於創建代價和跨域代價的對比，根據經驗選擇最合適的處理。
- 以局部變數代替多次使用的外部變數（xx.xx之類）。
- 若要調用外部函數，需直接在調用位置以局部變數獲得該函數，不要獲取該庫再 "." 函數，速度差5倍。
- 不要在for循環中創建表或閉包。
- 減少函數調用可以很大提高效率，但會降低代碼的可讀性，按需選擇。
- 因為創建空的table在插入數據時，會觸發容量重設，因此創建table時直接把參數直接寫在裡面可以很大提高效率，可以做到的情況盡量做到。
- string.format比..效率低很多，但可讀性大大提高，按需選擇。
- table.concat對記憶體的開銷較小，".."會一直產生一串新的字串。
- 判斷數組表是否為空時，一般情況用 #tab>0 即可，除非tab長度特別大，用next(tab)的效率才會更高。
- 因為require函數只能有一個返回值，如果想要多個返回值要弄成function()才行，詳見attributes。
- 有一個數組{[0] = 0, 1, 2, 3, 4, 5}，#、ipairs只會讀1-5，要pairs才會讀0-5。
- 如果table的數組段有元素要刪除，要使用table.remove，不要用nil去代替。另外，要由後往前刪除，或是返還一個新表，裡面儲存不想刪除的值。
- 如果table的string(hash)段有元素要刪除，使用nil即可。
- 判斷table是否為nil要寫next(tb) == 0。
- 使用string.gsub時，如果$在模式串的結尾，會有特殊的正則式作用，因此不要在結尾加$。
## 修改地圖
- 如果要修改地圖，請開啟TheTiltedClockTower.w3x，不要開啟.w3x。
- 修改完後要按Lni一次，vscode才會更新數據。
- 再按obj一次再執行會比較好。
## 新增/修改/移除物編數據
- 打開table資料夾。
- 根據類型開啟相應的ini檔。
- 直接修改儲存。注意，可使用"[=["和"]=]"把內容包括在裏頭，它會將enter鍵視為換行，空格鍵就空幾格，顏色照樣可以染。
- 最後用vscode執行obj一次即可。
## 新增/修改mpq數據
- map的資料夾下根據原目錄名創建資料夾。
- 把檔案放入資料夾中。
## 導入檔案
- 先把檔案放入resource裡面，根據檔案的類型放入不同資料夾。
- 在imp.ini填入剛剛放入的資料夾的路徑。
## 導入音效
- 先把檔案放入sound\war3mapImported裡面。
- 在imp.ini填入路徑。
- 要在war3map.j的globals設定全域變量**sound gg_snd_檔案名 = null**。
- 再去找InitSound函數，根據格式來調用函數，將音效檔初始化。
## 通魔
- 如果要播施法動作，請把施法持續時間和動作持續時間設定超過施法動作播一次的時間。
## 技能
- 技能要做2個，一個是一般技能，另一個是暗圖標。
## 任務
- 觸發物品的前綴一定是"[任務] "。
## 漂浮文字
- 系統會自動刪除無法永久顯示的漂浮文字，且內建回收利用的機制。

[ref_url5]:https://www.jianshu.com/p/a3a32e473cc4